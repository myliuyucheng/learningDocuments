# rust

## ç¬¬ä¸€ç« 


## ç®€ä»‹

### ä¸ºä»€ä¹ˆè¦ç”¨rust

* å¯ä»¥ç”¨æ¥æ›¿æ¢c/c++ï¼Œrustå’Œå®ƒä»¬å…·æœ‰åŒæ ·å¾—æ€§èƒ½ï¼Œä½†æ˜¯å¾ˆå¤šå¸¸è§å¾—bugåœ¨ç¼–è¯‘æ—¶å°±å¯ä»¥è¢«æ¶ˆç­
* rustå–„äºä¸€ä¸‹åœºæ™¯
  * éœ€è¦è¿è¡Œæ—¶å¾—é€Ÿåº¦
  * éœ€è¦å†…å­˜å®‰å…¨
  * æ›´å¥½å¾—åˆ©ç”¨å¤šå¤„ç†å™¨



### ä¸å…¶ä»–è¯­è¨€æ¯”è¾ƒ

* c/c++æ€§èƒ½éå¸¸å¥½ï¼Œä½†æ˜¯ç±»å‹ç³»ç»Ÿå’Œå†…å­˜éƒ½ä¸å®‰å…¨
* java/c#ï¼Œæ‹¥æœ‰GCï¼Œèƒ½ä¿è¯å†…å­˜å®‰å…¨ï¼Œä¹Ÿæœ‰å¾ˆå¤šä¼˜ç§€ç‰¹æ€§ï¼Œä½†æ˜¯æ€§èƒ½ä¸è¡Œã€‚
* Rust:
  * å®‰å…¨
  * æ— éœ€GC
  * æ˜“äºç»´æŠ¤ã€è°ƒè¯•ï¼Œä»£ç å®‰å…¨é«˜æ•ˆ




### Rustç‰¹åˆ«æ“…é•¿çš„é¢†åŸŸ

* é«˜æ€§èƒ½Web Service
* WebAssembly
* å‘½ä»¤è¡Œå·¥å…·
* ç½‘ç»œç¼–ç¨‹
* åµŒå…¥å¼è®¾å¤‡
* ç³»ç»Ÿç¼–ç¨‹

### Rustçš„ä¼˜ç‚¹

* æ€§èƒ½
* å®‰å…¨æ€§
* æ— æ‰€ç•æƒ§çš„å¹¶å‘

### Rustçš„ç¼ºç‚¹

* â€œéš¾å­¦â€

### æ³¨æ„

* Rustæœ‰å¾ˆå¤šç‹¬æœ‰çš„æ¦‚å¿µï¼Œå®ƒä»¬å’Œç°åœ¨å¤§å¤šä¸»æµè¯­è¨€éƒ½ä¸åŒã€‚
  * æ‰€ä»¥å­¦ä¹ Rustå¿…é¡»ä»åŸºç¡€æ¦‚å¿µä¸€æ­¥ä¸€æ­¥å­¦ï¼Œå¦åˆ™ä¼šæ‡µã€‚



## å®‰è£…Rust

### å®‰è£…rust

* å®˜ç½‘ï¼š[http://www.rust-lang.org]()
* linux or macï¼š
  * curl https://sh.rustup.rs -sSf | sh
* windowsï¼šæŒ‰å®˜ç½‘æŒ‡ç¤ºæ“ä½œ
* windows Subsystem for linuxï¼š
  * curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

### æ›´æ–°ä¸å¸è½½rust

* æ›´æ–°rust
  * rustup update
* å¸è½½rust
  * rustup self uninstall

### å®‰è£…éªŒè¯

* rustc --version
  - ç»“æœæ ¼å¼ï¼š rust x.y.zï¼ˆabcabcabc yyyy-mm-ddï¼‰
  - ä¼šæ˜¾ç¤ºæœ€æ–°ç¨³å®šç‰ˆå¾—ï¼šç‰ˆæœ¬å·ã€commit hashã€commit æ—¥æœŸ
  
  ![1726976526926](.\rust\1726976526926.jpg)

### æœ¬åœ°æ–‡æ¡£

* å®‰è£…rustå¾—æ—¶å€™ï¼Œè¿˜ä¼šåœ¨æœ¬åœ°å®‰è£…æ–‡æ¡£ï¼Œå¯ç¦»çº¿æµè§ˆ
* è¿è¡Œrustup doc å¯åœ¨æµè§ˆå™¨æ‰“å¼€æœ¬åœ°æ–‡æ¡£

### å¼€å‘æ–‡æ¡£

* Visual Studio Code
  * rustæ’ä»¶
* Clionï¼ˆIntellij Ideaç³»åˆ—ï¼‰
  * rustæ’ä»¶

 

## Hello World

### ç¼–å†™Rustç¨‹åº

* ç¨‹åºæ–‡ä»¶åç¼€åï¼šrs
* æ–‡ä»¶å‘½åè§„èŒƒï¼šhello_world.rs

![1727054754124](.\rust\1727054754124.jpg)

### ç¼–è¯‘ä¸è¿è¡ŒRustç¨‹åº

* ç¼–è¯‘ï¼šrustc main.rs
* è¿è¡Œï¼š 
  * Windowsï¼š .\main.exe
  * Linux/macï¼š ./main
  

### Rustç¨‹åºè§£å‰–

* å®šä¹‰å‡½æ•°ï¼šfn main() {}
  * æ²¡æœ‰å‚æ•°ï¼Œæ²¡æœ‰è¿”å›
* mainå‡½æ•°å¾ˆç‰¹åˆ«ï¼šå®ƒæ˜¯æ¯ä¸ªRustå¯æ‰§è¡Œç¨‹åºæœ€å…ˆè¿è¡Œå¾—ä»£ç 
* æ‰“å°æ–‡æœ¬ï¼š println!("Hello, world!");
  * Rustå¾—ç¼©è¿›æ˜¯4ä¸ªç©ºæ ¼è€Œä¸æ˜¯tab
  * println!æ˜¯ä¸€ä¸ªRust macroï¼ˆå®ï¼‰
    * å¦‚æœæ˜¯å‡½æ•°å¾—è¯ï¼Œå°±æ²¡æœ‰ï¼
  * "Hello World"æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯println!å¾—å‚æ•°
  * è¿™è¡Œä»£ç æ˜¯ï¼›ç»“å°¾

### ç¼–è¯‘å’Œè¿è¡Œæ˜¯å•ç‹¬å¾—ä¸¤æ­¥

* è¿è¡ŒRustç¨‹åºä¹‹å‰å¿…é¡»å…ˆç¼–è¯‘ï¼Œå‘½ä»¤ä¸ºï¼šrustc æºæ–‡ä»¶å
  * rustc main.rs
* ç¼–è¯‘æˆåŠŸåï¼Œä¼šç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶
  * åœ¨Windowsä¸Šè¿˜ä¼šç”Ÿæˆä¸€ä¸ª.pdbæ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«è°ƒè¯•ä¿¡æ¯
  
  ![1727054869108](.\rust\1727054869108.jpg)
* Rustæ˜¯ahead-of-timeç¼–è¯‘å¾—è¯­è¨€ï¼ˆé¢„å…ˆç¼–è¯‘è¯­è¨€ï¼‰
  * å¯ä»¥å…ˆç¼–è¯‘ç¨‹åºï¼Œç„¶åæŠŠå¯æ‰§è¡Œæ–‡ä»¶äº¤ç»™åˆ«äººè¿è¡Œï¼ˆæ— éœ€å®‰è£…rustï¼‰
* rustcåªé€‚åˆç®€å•å¾—rustç¨‹åº



## Hello Cargo

### Cargo

* cargo æ˜¯Rustçš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å·¥å…·
  * æ„å»ºä»£ç ã€ä¸‹è½½ä¾èµ–çš„åº“ã€æ„å»ºè¿™äº›åº“â€¦â€¦
* å®‰è£…Rustçš„æ—¶å€™ä¼šå®‰è£…Cargo
  * cargo --versionï¼ˆæŸ¥çœ‹ç‰ˆæœ¬ï¼‰

### ä½¿ç”¨Cargoåˆ›å»ºé¡¹ç›®

* åˆ›å»ºé¡¹ç›®ï¼šcargo new hello_cargo

  * é¡¹ç›®åç§°ä¹Ÿæ˜¯hello_cargo

  * ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•hello_cargo

    * cargo.toml

    * srcç›®å½•

      * main.js

    * åˆå§‹åŒ–äº†ä¸€ä¸ªæ–°çš„Gitä»“åº“ï¼Œ.gitignore

      * å¯ä»¥ä½¿ç”¨å…¶ä»–çš„VCSæˆ–ä¸ä½¿ç”¨VCSï¼šcargo new çš„æ—¶å€™ä½¿ç”¨ --vcs è¿™ä¸ªflag

      ![1727093529749](.\rust\1727093529749.jpg)

### Cargo.toml

![1727093857977](.\rust\1727093857977.jpg)

* tomlï¼ˆTom's Obvious, Minimal Language)æ ¼å¼ï¼Œæ˜¯Cargoçš„é…ç½®æ ¼å¼

* [package]ï¼Œæ˜¯ä¸€ä¸ªåŒºåŸŸæ ‡é¢˜ï¼Œè¡¨ç¤ºä¸‹æ–¹å†…å®¹æ˜¯ç”¨æ¥é…ç½®åŒ…ï¼ˆpackageï¼‰çš„
  * nameï¼Œé¡¹ç›®å
  * versionï¼Œé¡¹ç›®ç‰ˆæœ¬
  * authorsï¼Œé¡¹ç›®ä½œè€…
  * editionï¼Œä½¿ç”¨çš„Rustç‰ˆæœ¬
* [dependencies]ï¼Œå¦ä¸€ä¸ªåŒºåŸŸçš„å¼€å§‹ï¼Œå®ƒä¼šåˆ—å‡ºé¡¹ç›®çš„ä¾èµ–é¡¹ã€‚
* åœ¨Rusté‡Œé¢ï¼Œä»£ç çš„åŒ…ç§°ä½œCrateã€‚



### src / main.rs

* cargoç”Ÿæˆçš„main.rsåœ¨srcç›®å½•ä¸‹
* è€ŒCargo.tomlåœ¨é¡¹ç›®é¡¶å±‚ä¸‹
* æºä»£ç éƒ½åº”è¯¥åœ¨srcç›®å½•ä¸‹
* é¡¶å±‚ç›®å½•å¯ä»¥æ”¾ç½®ï¼šREADMEã€è®¸å¯ä¿¡æ¯ã€é…ç½®æ–‡ä»¶å’Œå…¶ä»–ä¸ç¨‹åºæºä»£ç æ— å…³çš„æ–‡ä»¶
* å¦‚æœåˆ›å»ºé¡¹ç›®æ—¶æ²¡æœ‰ä½¿ç”¨cargoï¼Œä¹Ÿå¯ä»¥æŠŠé¡¹ç›®è½¬åŒ–ä¸ºä½¿ç”¨cargoï¼š
  * æŠŠæºä»£ç æ–‡ä»¶ç§»åŠ¨åˆ°srcä¸‹
  * åˆ›å»ºCargo.tomlå¹¶å¡«å†™ç›¸åº”çš„é…ç½®



### æ„å»ºCargoé¡¹ç›® --- cargo build

* cargo build
  * åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶ï¼štarget / debug / hello_cargo æˆ– target \ debug \ hello_cargo.exeï¼ˆWindowsï¼‰
  * è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼š./target/debug/hello_cargo æˆ– .\target\debug\hello_cargo.exeï¼ˆWindowsï¼‰
* ç¬¬ä¸€æ¬¡è¿è¡Œcargo buildä¼šåœ¨é¡¶å±‚ç›®å½•ç”Ÿæˆcargo.lockæ–‡ä»¶
  * è¯¥æ–‡ä»¶è´Ÿè´£è¿½è¸ªé¡¹ç›®ä¾èµ–çš„ç²¾ç¡®ç‰ˆæœ¬
  * ä¸éœ€è¦æ‰‹åŠ¨ä¿®æ”¹è¯¥æ–‡ä»¶



### æ„å»ºå’Œè¿è¡Œcargoé¡¹ç›® --- cargo run

![1727094736994](.\rust\1727094736994.jpg)

* cargo runï¼Œç¼–è¯‘ä»£ç  + æ‰§è¡Œç»“æœ
  * å¦‚æœä¹‹å‰ç¼–è¯‘æˆåŠŸè¿‡ï¼Œå¹¶ä¸”æºä»£ç æ²¡æœ‰æ”¹å˜ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶



### cargo check

* cargo checkï¼Œæ£€æŸ¥ä»£ç ï¼Œç¡®ä¿èƒ½é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ä¸äº§ç”Ÿä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶
* cargo checkè¦æ¯”cargo buildå¿«çš„å¤š
  * ç¼–å†™ä»£ç çš„æ—¶å€™å¯ä»¥è¿ç»­åå¤çš„ä½¿ç”¨cargo checkæ£€æŸ¥ä»£ç ï¼Œæé«˜æ•ˆç‡



### ä¸ºå‘å¸ƒæ„å»º

* cargo build --release
  * ç¼–è¯‘æ—¶ä¼šè¿›è¡Œä¼˜åŒ–
    * ä»£ç ä¼šè¿è¡Œçš„æ›´å¿«ï¼Œä½†æ˜¯ç¼–è¯‘æ—¶é—´æ›´é•¿
  * ä¼šåœ¨ `target/release`è€Œä¸æ˜¯`target/debug`ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶
* ä¸¤ç§é…ç½®ï¼š
  * ä¸€ä¸ªå¼€å‘
  * ä¸€ä¸ªæ­£å¼å‘å¸ƒ

## ç¬¬äºŒç« 



### çŒœæ•°æ¸¸æˆï¼šä¸€æ¬¡çŒœæµ‹

* å­¦ä¼šä»€ä¹ˆï¼š
  * letã€matchç­‰æ–¹æ³•
  * ç›¸å…³çš„å‡½æ•°
  * å¤–éƒ¨çš„crate
  * â€¦â€¦

#### ç›®æ ‡

* ç”Ÿæˆä¸€ä¸ª1åˆ°100é—´çš„éšæœºæ•°
* æç¤ºç©å®¶è¾“å…¥ä¸€ä¸ªçŒœæµ‹
* çŒœå®Œä¹‹åï¼Œç¨‹åºä¼šæç¤ºçŒœæµ‹æ˜¯å¤ªå°äº†è¿˜æ˜¯å¤ªå¤§äº†
* å¦‚æœçŒœæµ‹æ­£ç¡®ï¼Œé‚£ä¹ˆæ‰“å°å‡ºä¸€ä¸ªåº†ç¥ä¿¡æ¯ï¼Œç¨‹åºé€€å‡º

````rust
use std::io;
// std æ ‡å‡†åº“

fn main() {
    println!("çŒœæ•°ï¼");

    println!("çŒœæµ‹ä¸€ä¸ªæ•°ï¼š");

    // let mut foo = 1;
    // let bar = foo; //é»˜è®¤æ˜¯ä¸å¯å˜çš„ immutable
    // foo = 2;

    // ä½¿ç”¨utf-8ç¼–ç ï¼Œå¯ä»¥æŒ‰è‡ªå·±çš„éœ€æ±‚æ‰©å±•è‡ªå·±çš„å¤§å°
    // ï¼šnewæ˜¯stringç±»å‹çš„å…³è”å‡½æ•°ï¼Œé’ˆå¯¹ç±»å‹æœ¬èº«æ¥å®ç°çš„ï¼Œç›¸å½“äºc#,javaçš„é™æ€æ–¹æ³•ï¼Œnewåœ¨rusté‡Œé¢åˆ›å»ºç±»å‹å®åˆ—çš„æƒ¯ç”¨åç§°
    let mut guess = String::new();  

    // read_line ï¼š rustæ ‡å‡†åº“é‡Œé¢æœ‰å¥½å¤šResultç±»å‹ï¼ŒResultæšä¸¾ç±»å‹
    io::stdin().read_line(&mut guess).expect("æ— æ³•è¯»å–è¡Œ");
    // io::Result Ok, Err

    println!("ä½ çŒœæµ‹çš„æ•°æ˜¯ï¼š{}", guess);
}

````



### 2.2 çŒœæ•°æ¸¸æˆ - ç”Ÿæˆç¥ç§˜æ•°å­—

[ä¸‹è½½åº“çš„åœ°å€](https://crates.io/)

![1727098581228](.\rust\1727098581228.jpg)

* æ ¹æ®`cargo.toml`ç”Ÿæˆæ›´æ–°åçš„`cargo.lock`æ–‡ä»¶ `cargo update`

````rust
use rand::Rng;
use std::io;

fn main() {
    println!("çŒœæ•°ï¼");

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!("ç¥ç§˜æ•°å­—æ˜¯ï¼š{}", secret_number);

    println!("çŒœæµ‹ä¸€ä¸ªæ•°ï¼š");

    // let mut foo = 1;
    // let bar = foo; //é»˜è®¤æ˜¯ä¸å¯å˜çš„ immutable
    // foo = 2;

    // ä½¿ç”¨utf-8ç¼–ç ï¼Œå¯ä»¥æŒ‰è‡ªå·±çš„éœ€æ±‚æ‰©å±•è‡ªå·±çš„å¤§å°
    // ï¼šnewæ˜¯stringç±»å‹çš„å…³è”å‡½æ•°ï¼Œé’ˆå¯¹ç±»å‹æœ¬èº«æ¥å®ç°çš„ï¼Œç›¸å½“äºc#,javaçš„é™æ€æ–¹æ³•ï¼Œnewåœ¨rusté‡Œé¢åˆ›å»ºç±»å‹å®åˆ—çš„æƒ¯ç”¨åç§°
    let mut guess = String::new();

    // read_line ï¼š rustæ ‡å‡†åº“é‡Œé¢æœ‰å¥½å¤šResultç±»å‹ï¼ŒResultæšä¸¾ç±»å‹
    io::stdin().read_line(&mut guess).expect("æ— æ³•è¯»å–è¡Œ");
    // io::Result Ok, Err

    println!("ä½ çŒœæµ‹çš„æ•°æ˜¯ï¼š{}", guess);
}

````

### 2.3 çŒœæ•°æ¸¸æˆ - æ¯”è¾ƒçŒœæµ‹æ•°å­—ä¸ç¥ç§˜æ•°å­—

````rust
use rand::Rng;
use std::cmp::Ordering;
use std::io;

fn main() {
    println!("çŒœæ•°ï¼");

    let secret_number = rand::thread_rng().gen_range(1, 101);

    println!("ç¥ç§˜æ•°å­—æ˜¯ï¼š{}", secret_number);

    println!("çŒœæµ‹ä¸€ä¸ªæ•°ï¼š");

    // let mut foo = 1;
    // let bar = foo; //é»˜è®¤æ˜¯ä¸å¯å˜çš„ immutable
    // foo = 2;

    // ä½¿ç”¨utf-8ç¼–ç ï¼Œå¯ä»¥æŒ‰è‡ªå·±çš„éœ€æ±‚æ‰©å±•è‡ªå·±çš„å¤§å°
    // ï¼šnewæ˜¯stringç±»å‹çš„å…³è”å‡½æ•°ï¼Œé’ˆå¯¹ç±»å‹æœ¬èº«æ¥å®ç°çš„ï¼Œç›¸å½“äºc#,javaçš„é™æ€æ–¹æ³•ï¼Œnewåœ¨rusté‡Œé¢åˆ›å»ºç±»å‹å®åˆ—çš„æƒ¯ç”¨åç§°
    let mut guess = String::new();

    // read_line ï¼š rustæ ‡å‡†åº“é‡Œé¢æœ‰å¥½å¤šResultç±»å‹ï¼ŒResultæšä¸¾ç±»å‹
    io::stdin().read_line(&mut guess).expect("æ— æ³•è¯»å–è¡Œ");
    // io::Result Ok, Err

    // shadowï¼ˆéšè—ç‰¹æ€§ï¼‰ï¼Œrusté‡Œé¢çš„shadowç‰¹æ€§ï¼Œå¯ä»¥éšè—å˜é‡ï¼Œå˜é‡åå¯ä»¥é‡å¤ï¼Œä¸€èˆ¬ç”¨åœ¨ç±»å‹è½¬æ¢çš„æ—¶å€™
    let guess: u32 = guess.trim().parse().expect("è§£æå¤±è´¥ï¼");

    println!("ä½ çŒœæµ‹çš„æ•°æ˜¯ï¼š{}", guess);

    match guess.cmp(&secret_number) {
        Ordering::Less => println!("å°äº†"), // arm matchæ‰‹è‡‚ï¼Œä»–ä¼šä»ä¸Šåˆ°ä¸‹ä»¥æ­¤åŒ¹é…
        Ordering::Greater => println!("å¤§å•¦"),
        Ordering::Equal => println!("çŒœå¯¹äº†"),
    }
}

````

 ### 2.4 çŒœæ•°æ¸¸æˆ - å…è®¸å¤šæ¬¡çŒœæµ‹

````rust
use rand::Rng;
use std::cmp::Ordering;
use std::io;

fn main() {
    println!("çŒœæ•°ï¼");

    let secret_number = rand::thread_rng().gen_range(1, 101);

    loop {
        println!("çŒœæµ‹ä¸€ä¸ªæ•°ï¼š");

        let mut guess = String::new();
        // read_line ï¼š rustæ ‡å‡†åº“é‡Œé¢æœ‰å¥½å¤šResultç±»å‹ï¼ŒResultæšä¸¾ç±»å‹
        io::stdin().read_line(&mut guess).expect("æ— æ³•è¯»å–è¡Œ");
        // io::Result Ok, Err

        // shadowï¼ˆéšè—ç‰¹æ€§ï¼‰ï¼Œrusté‡Œé¢çš„shadowç‰¹æ€§ï¼Œå¯ä»¥éšè—å˜é‡ï¼Œå˜é‡åå¯ä»¥é‡å¤ï¼Œä¸€èˆ¬ç”¨åœ¨ç±»å‹è½¬æ¢çš„æ—¶å€™
        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };

        println!("ä½ çŒœæµ‹çš„æ•°æ˜¯ï¼š{}", guess);

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("å°äº†"), // arm matchæ‰‹è‡‚ï¼Œä»–ä¼šä»ä¸Šåˆ°ä¸‹ä»¥æ­¤åŒ¹é…
            Ordering::Greater => println!("å¤§å•¦"),
            Ordering::Equal => {
                println!("çŒœå¯¹äº†");
                break;
            }
        }
    }
}

````

## ç¬¬3ç«  é€šç”¨çš„ç¼–ç¨‹æ¦‚å¿µ

* å˜é‡ä¸å¯å˜æ€§
* æ•°æ®ç±»å‹
  * æ ‡é‡ç±»å‹
  * å¤åˆç±»å‹
* å‡½æ•°
* æ³¨é‡Š
* æ§åˆ¶æµ

### 3.1 å˜é‡ä¸å¯å˜æ€§

* å£°æ˜å˜é‡ä½¿ç”¨`let`å…³é”®è¯

* é»˜è®¤æƒ…å†µä¸‹ï¼Œå˜é‡æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰

  ````rust
  fn main() {
      println!("Hello, world!");
  
      let mut x = 5;
      println!("The value of x is {}", x);
  
      x = 6;
      println!("The value of x is {}", x);
  }
  ````

* å£°æ˜å˜é‡æ—¶ï¼Œåœ¨å˜é‡å‰é¢åŠ ä¸Š`mut`ï¼Œå°±å¯ä»¥ä½¿å˜é‡å¯å˜ã€‚

#### å˜é‡ä¸å¸¸é‡

* å¸¸é‡ï¼ˆconstantï¼‰ï¼Œå¸¸é‡åœ¨ç»‘å®šå€¼ä»¥åä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œä½†æ˜¯å®ƒä¸ä¸å¯å˜çš„å˜é‡æœ‰å¾ˆå¤šåŒºåˆ«ï¼š
  * ä¸å¯ä»¥ä½¿ç”¨`mut`ï¼Œå¸¸é‡æ°¸è¿œéƒ½æ˜¯ä¸å¯å˜çš„
  * å£°æ˜å¸¸é‡ä½¿ç”¨`const`å…³é”®è¯ï¼Œå®ƒçš„ç±»å‹å¿…é¡»è¢«æ ‡æ³¨
  * å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸå†…è¿›è¡Œå£°æ˜ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸ
  * å¸¸é‡åªå¯ä»¥ç»‘å®šåˆ°å¸¸é‡è¡¨è¾¾å¼ï¼Œæ— æ³•ç»‘å®šåˆ°å‡½æ•°çš„è°ƒç”¨ç»“æœæˆ–åªèƒ½åœ¨è¿è¡Œæ—¶æ‰èƒ½è®¡ç®—å‡ºçš„å€¼
* åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œå¸¸é‡åœ¨å…¶å£°æ˜çš„ä½œç”¨åŸŸå†…ä¸€ç›´æœ‰æ•ˆ
* å‘½åè§„èŒƒï¼šRusté‡Œå¸¸é‡ä½¿ç”¨å…¨å¤§å†™å­—æ¯ï¼Œæ¯ä¸ªå•è¯ä¹‹é—´ç”¨ä¸‹åˆ’çº¿åˆ†å¼€ï¼Œä¾‹å¦‚ï¼š
  * MAX_POINTS
* ä¾‹å­ï¼š`const MAX_POINTS: u32 = 100_000`

#### Shadowingï¼ˆéšè—ï¼‰

* å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åç§°å£°æ˜æ–°çš„å˜é‡ï¼Œæ–°çš„å˜é‡å°±ä¼šshadowï¼ˆéšè—ï¼‰ä¹‹å‰å£°æ˜çš„åŒåå˜é‡
  * åœ¨åç»­çš„ä»£ç ä¸­è¿™ä¸ªå˜é‡åä»£è¡¨çš„å°±æ˜¯æ–°çš„å˜é‡
* shadowå’ŒæŠŠå˜é‡æ ‡è®°ä¸ºmutæ˜¯ä¸ä¸€æ ·çš„ï¼š
  * å¦‚æœä¸ä½¿ç”¨letå…³é”®å­—ï¼Œé‚£ä¹ˆé‡æ–°ç»™émutçš„å˜é‡èµ‹å€¼ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯
  * è€Œä½¿ç”¨letå£°æ˜çš„åŒåæ–°å˜é‡ï¼Œä¹Ÿæ˜¯ä¸å¯å˜çš„
  * ä½¿ç”¨letå£°æ˜çš„åŒåæ–°å˜é‡ï¼Œå®ƒçš„ç±»å‹å¯ä»¥ä¸ä¹‹å‰ä¸åŒ

````rust
fn main() {
    let x = 1;
    let x = x + 1;
    let x = x * 2;

    println!("The value of x is: {}", x);

    let spaces = "    ";
    let spaces = spaces.len();

    println!("{}", spaces);
}

````



### 3.2æ•°æ®ç±»å‹

* æ ‡é‡å’Œå¤åˆç±»å‹

* Rustæ˜¯é™æ€ç¼–è¯‘è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹

  * åŸºäºä½¿ç”¨çš„å€¼ï¼Œç¼–è¯‘å™¨é€šå¸¸èƒ½å¤Ÿæ¨æ–­å‡ºå®ƒçš„å…·ä½“ç±»å‹

  * ä½†æ˜¯å¦‚æœå¯èƒ½çš„ç±»å‹æ¯”è¾ƒå¤šï¼ˆä¾‹å¦‚æŠŠStringè½¬ä¸ºæ•´æ•°çš„parseæ–¹æ³•ï¼‰ï¼Œå°±å¿…é¡»æ·»åŠ ç±»å‹çš„æ ‡æ³¨ï¼Œå¦åˆ™ç¼–è¯‘ä¼šæŠ¥é”™

    ````rust
    fn main() {
        // let guess = "42".parse().expect("Not a number!");
        let guess: u32 = "42".parse().expect("Not a number!");
    
        println!("{}", guess)
    }
    
    ````

    

#### æ ‡é‡ç±»å‹

* ä¸€ä¸ªæ ‡é‡ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ä¸ªçš„å€¼
* Rustæœ‰å››ä¸ªä¸»è¦çš„æ ‡é‡ç±»å‹ï¼š
  * æ•´æ•°ç±»å‹
  * æµ®ç‚¹ç±»å‹
  * å¸ƒå°”ç±»å‹
  * å­—ç¬¦ç±»å‹

#### æ•´æ•°ç±»å‹

* è¯ä¹¦ç±»å‹æ²¡æœ‰å°æ•°éƒ¨åˆ†

* ä¾‹å¦‚`u32`å°±æ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„æ•´æ•°ç±»å‹ï¼Œå æ®32ä½çš„ç©ºé—´

* æ— ç¬¦å·æ•´æ•°ç±»å‹ä»¥ U å¼€å¤´

* æœ‰ç¬¦å·æ•´æ•°ç±»å‹ä»¥ i å¼€å¤´

* Rustçš„æ•´æ•°ç±»å‹åˆ—è¡¨å¦‚å›¾ï¼š

  * æ¯ç§éƒ½åˆ† i å’Œ uï¼Œ ä»¥åŠå›ºå®šçš„ä½æ•°
  * æœ‰ç¬¦å·èŒƒå›´ï¼š

  $$
  -(2^n - 1) åˆ° 2^{n-1} - 1
  $$

  * æ— ç¬¦å·èŒƒå›´ï¼š

  $$
  0 åˆ° 2^n - 1
  $$



![1727183160244](.\rust\1727183160244.jpg)

#### isize å’Œ usizeç±»å‹

* isize å’Œ usize ç±»å‹çš„ä½æ•°ç”±ç¨‹åºè¿è¡Œçš„è®¡ç®—æœºçš„æ¶æ„æ‰€å†³å®šï¼š
  * å¦‚æœæ˜¯64ä½è®¡ç®—æœºï¼Œé‚£å°±æ˜¯64ä½çš„
  * â€¦â€¦
* ä½¿ç”¨ isize æˆ– usize çš„ä¸»è¦åœºæ™¯æ˜¯å¯¹æŸç§é›†åˆè¿›è¡Œç´¢å¼•æ“ä½œã€‚

#### æ•´æ•°å­—é¢å€¼

* é™¤äº†byteç±»å‹å¤–ï¼Œæ‰€æœ‰çš„æ•°å€¼å­—é¢å€¼éƒ½å…è®¸ä½¿ç”¨ç±»å‹åç¼€ã€‚
  * ä¾‹å¦‚ `57u8`
* å¦‚æœä½ ä¸å¤ªæ¸…æ¥šåº”è¯¥ä½¿ç”¨é‚£ç§ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨Rustç›¸åº”çš„é»˜è®¤ç±»å‹ï¼š
* æ•´æ•°çš„é»˜è®¤ç±»å‹å°±æ˜¯`i32`ï¼š
  * æ€»ä½“ä¸Šæ¥è¯´é€Ÿåº¦å¾ˆå¿«ï¼Œå³ä½¿åœ¨64ä½ç³»ç»Ÿä¸­

![1727183877312](.\rust\1727183877312.jpg)

#### æ•´æ•°æº¢å‡º

* ä¾‹å¦‚ï¼šu8çš„èŒƒå›´æ˜¯ 0 - 255ï¼Œå¦‚æœä½ æŠŠä¸€ä¸ª u8 å˜é‡çš„å€¼è®¾ä¸º 256ï¼Œé‚£ä¹ˆï¼š
  * è°ƒå¼æ¨¡å¼ä¸‹ç¼–è¯‘ï¼šRustä¼šæ£€æŸ¥æ•´æ•°æº¢å‡ºï¼Œå¦‚æœå‘ç”Ÿæº¢å‡ºï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶å°±ä¼španic
  * å‘å¸ƒæ¨¡å¼ä¸‹ï¼ˆ--releaseï¼‰ç¼–è¯‘ï¼šRustä¸ä¼šæ£€æŸ¥å¯èƒ½å¯¼è‡´panicçš„æ•´æ•°æº¢å‡º
    * å¦‚æœæº¢å‡ºå‘ç”Ÿï¼šRustä¼šæ‰§è¡Œâ€œç¯ç»•â€æ“ä½œï¼š
      * 256 å˜æˆ 0ï¼Œ 257 å˜æˆ 1 â€¦â€¦
    * ä½†ç¨‹åºä¸ä¼španic

#### æµ®ç‚¹ç±»å‹

* rustæœ‰ä¸¤ç§åŸºç¡€çš„æµ®ç‚¹ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å«æœ‰å°æ•°éƒ¨åˆ†çš„ç±»å‹

  * `f32`ï¼Œ32ä½ï¼Œå•ç²¾åº¦
  * `f64`ï¼Œ64ä½ï¼ŒåŒç²¾åº¦

* rustçš„æµ®ç‚¹ç±»å‹ä½¿ç”¨äº† `IEEE-754`æ ‡å‡†æ¥è¡¨è¿°

* `f64`çš„é»˜è®¤ç±»å‹ï¼Œå› ä¸ºåœ¨ç°ä»£CPUä¸Š`f64`å’Œ`f32`çš„é€Ÿåº¦å·®ä¸å¤šï¼Œè€Œä¸”ç²¾åº¦æ›´é«˜

  ````rust
  fn main() {
      let x = 4.0;    // f64
  
      let y: f32 = 5.0;       // f32
  }
  ````

  

#### æ•°å€¼æ“ä½œ

* åŠ å‡ä¹˜é™¤ä½™ç­‰

````rust
fn main() {
    let sum = 5 + 10;

    let difference = 95.5 - 4.3;

    let product = 4 * 30;

    let quotient = 56.7 / 32.2;

    let reminder = 54 % 5;
}
````

#### å¸ƒå°”ç±»å‹

* rustçš„å¸ƒå°”ç±»å‹ä¹Ÿæœ‰ä¸¤ä¸ªå€¼ï¼š `ture`å’Œ`false`

* ä¸€ä¸ªå­—èŠ‚å¤§å°

* ç¬¦å·æ˜¯`bool`

  ````rust
  fn main() {
      let t = true;
      let f: bool = false;
  }
  ````

#### å­—ç¬¦ç±»å‹

* rustè¯­è¨€ä¸­charç±»å‹è¢«ç”¨æ¥æè¿°è¯­è¨€ä¸­æœ€åŸºç¡€çš„å•ä¸ªå­—ç¬¦
* å­—ç¬¦ç±»å‹çš„å­—é¢å€¼ä½¿ç”¨å•å¼•å·
* å ç”¨4å­—èŠ‚å¤§å°
* æ˜¯`Unicode`æ ‡é‡å€¼ï¼Œå¯ä»¥è¡¨ç¤ºæ¯”`ASCII`å¤šå¾—å¤šçš„å­—ç¬¦å†…å®¹ï¼šæ‹¼éŸ³ã€ä¸­æ—¥éŸ©ã€é›¶é•¿åº¦ç©ºç™½å­—ç¬¦ã€emojiè¡¨æƒ…ç­‰ã€‚
  * U+0000 åˆ° U+D7FF
  * U+E000 åˆ° U+10FFFF
* ä½†æ˜¯`Unicode `ä¸­å¹¶æ²¡æœ‰â€œå­—ç¬¦â€çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›´è§‰ä¸Šè®¤ä¸ºçš„å­—ç¬¦ä¹Ÿè®¸ä¸Rustä¸­çš„æ¦‚å¿µå¹¶ä¸ç›¸ç¬¦

```` rust
fn main() {
    let x = 'z';
    let z = 'ğŸ˜€';
}
````



### 3.3 å¤åˆç±»å‹

* å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œã€‚
* Rustæä¾›äº†ä¸¤ç§åŸºç¡€çš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆTupleï¼‰ã€æ•°ç»„

#### Tuple

* Tupleå¯ä»¥å°†å¤šä¸ªç±»å‹çš„å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œ
* Tupleçš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼šä¸€æ—¦å£°æ˜å°±æ— æ³•æ”¹å˜

##### åˆ›å»ºTuple

* åœ¨å°æ‹¬å·é‡Œï¼Œå°†å€¼ç”¨é€—å·åˆ†å¼€
* Tupleä¸­çš„æ¯ä¸ªä½ç½®éƒ½å¯¹åº”ä¸€ä¸ªç±»å‹ï¼ŒTupleä¸­å„å…ƒç´ çš„ç±»å‹ä¸å¿…ç›¸åŒ

```` rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    println!("{}, {}, {},", tup.0, tup.1, tup.2);
}
````

##### è·å–tupleçš„å…ƒç´ å€¼

* å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥è§£æ„ï¼ˆdestructureï¼‰ä¸€ä¸ªTupleæ¥è·å–å…ƒç´ çš„å€¼

  ````rust
  fn main() {
      let tup: (i32, f64, u8) = (500, 6.4, 1);
      
      let (x, y, z) = tup
      println!("{}, {}, {},", x, y, z);
  }
  ````

##### è®¿é—®Tupleçš„å…ƒç´ 

* åœ¨tupleå˜é‡ä½¿ç”¨ç‚¹æ ‡è®°æ³•ï¼Œåæ¥å…ƒç´ çš„ç´¢å¼•å·

#### æ•°ç»„

* æ•°ç»„ä¹Ÿå¯ä»¥å°†å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œ
* æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒ
* æ•°ç»„çš„é•¿åº¦ä¹Ÿæ˜¯å›ºå®šçš„

##### å£°æ˜ä¸€ä¸ªæ•°ç»„

* åœ¨ä¸­æ‹¬å·é‡Œï¼Œå„å€¼ç”¨é€—å·åˆ†å¼€

````rust
fn main() {
    let arr = [1, 2, 3, 4, 5];
}
````

##### æ•°ç»„çš„ç”¨å¤„

* å¦‚æœæƒ³è®©ä½ çš„æ•°ç»„å­˜æ”¾åœ¨`stack`ï¼ˆæ ˆï¼‰ä¸Šè€Œä¸æ˜¯`heap`ï¼ˆå †ï¼‰ä¸Šï¼Œæˆ–è€…æƒ³ä¿è¯æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œè¿™æ—¶ä½¿ç”¨æ•°ç»„æ›´æœ‰å¥½å¤„
* æ•°ç»„æ²¡æœ‰`Vector`çµæ´»
  * `Vector`å’Œæ•°ç»„ç±»ä¼¼ï¼Œå®ƒç”±æ ‡å‡†åº“æä¾›
  * `Vector`çš„é•¿åº¦å¯ä»¥æ”¹å˜
  * å¦‚æœä½ ä¸ç¡®å®šåº”è¯¥ç”¨æ•°ç»„è¿˜æ˜¯`Vector`ï¼Œé‚£ä¹ˆä¼°è®¡ä½ åº”è¯¥ç”¨`Vector`ã€‚

##### æ•°ç»„çš„ç±»å‹

* æ•°ç»„çš„ç±»å‹ä»¥è¿™ç§å½¢å¼è¡¨ç¤ºï¼š[ç±»å‹; é•¿åº¦]
  * ä¾‹å¦‚ï¼š `let a: [i32; 5] = [1,2,3,4,5];`

##### å¦ä¸€ç§å£°æ˜æ•°ç»„çš„æ–¹æ³•

* å¦‚æœæ•°ç»„çš„æ¯ä¸ªå…ƒç´ å€¼éƒ½ç›¸åŒï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ï¼š
  * åœ¨ä¸­æ‹¬å·é‡ŒæŒ‡å®šåˆå§‹å€¼
  * ç„¶åæ˜¯ä¸€ä¸ªâ€œï¼›â€
  * æœ€åæ˜¯æ•°ç»„çš„é•¿åº¦
* ä¾‹å¦‚ï¼š`let a = [3; 5];`å®ƒå°±ç›¸å½“äºï¼š`let a = [3,3,3,3,3];`

##### è®¿é—®æ•°ç»„çš„å…ƒç´ 

* æ•°ç»„æ˜¯`Stack`ä¸Šåˆ†é…çš„å•ä¸ªå—çš„å†…å­˜

* å¯ä»¥ä½¿ç”¨ç´¢å¼•æ¥è®¿é—®æ•°ç»„çš„å…ƒç´ 

  * `a[0]`

* å¦‚æœè®¿é—®çš„ç´¢å¼•è¶…å‡ºäº†æ•°ç»„çš„èŒƒå›´ï¼Œé‚£ä¹ˆï¼š

  * ç¼–è¯‘ä¼šé€šè¿‡

  * è¿è¡Œä¼šæŠ¥é”™ï¼ˆruntimeæ—¶ä¼španicï¼‰

    * Rustä¸ä¼šå…è®¸å…¶ç»§ç»­è®¿é—®ç›¸åº”åœ°å€çš„å†…å­˜

    ![1727185908048](.\rust\1727185908048.jpg)

### 3.4 å‡½æ•°

* å£°æ˜å‡½æ•°ä½¿ç”¨`fn`å…³é”®å­—
* ä¾ç…§æƒ¯ä¾‹ï¼Œé’ˆå¯¹å‡½æ•°å’Œå˜é‡åï¼ŒRustä½¿ç”¨`snake case`å‘½åè§„èŒƒï¼š
  * æ‰€æœ‰çš„å­—æ¯éƒ½æ˜¯å°å†™çš„ï¼Œå•è¯ä¹‹é—´ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†å¼€

````rust
fn main() {
    println!("hello world");
    another_function();
}

fn another_function() {
    println!("Another function");
}
````

##### å‡½æ•°çš„å‚æ•°

* parametersï¼ˆå®šä¹‰æ—¶çš„å‚æ•°ï¼‰,argumentï¼ˆè°ƒç”¨æ—¶çš„å‚æ•°ï¼‰
* åœ¨å‡½æ•°ç­¾åé‡Œï¼Œå¿…é¡»å£°æ˜æ¯ä¸ªå‚æ•°çš„ç±»å‹

````rust
fn main() {
    println!("hello world");
    another_function(5);	// argument
}

fn another_function(x: i32) {	// parameter
    println!("Another function");
}
````

##### å‡½æ•°ä½“ä¸­çš„è¯­å¥ä¸è¡¨è¾¾å¼

* å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œå¯é€‰çš„ç”±ä¸€ä¸ªè¡¨è¾¾å¼ç»“æŸ
* Rustæ˜¯ä¸€ä¸ªåŸºäºè¡¨è¾¾å¼çš„è¯­è¨€
* è¯­å¥æ˜¯æ‰§è¡Œä¸€äº›åŠ¨ä½œçš„æŒ‡ä»¤
* è¡¨è¾¾å¼ä¼šè®¡ç®—äº§å‡ºä¸€ä¸ªå€¼
* å‡½æ•°çš„å®šä¹‰ä¹Ÿæ˜¯è¯­å¥
* è¯­å¥ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸å¯ä»¥ä½¿ç”¨letå°†ä¸€ä¸ªè¯­å¥èµ‹ç»™ä¸€ä¸ªå˜é‡

```` rust
fn main() {
    //let x = (let y = 6); // panic
    
    let x = 5;
    let y = {
        let x = 1;
        x + 3
        //x + 3; //è¿”å›ç©ºå…ƒç»„()
    };
    
    println!("The value of y is: {}", y);
}
````

##### å‡½æ•°çš„è¿”å›å€¼

* åœ¨ `->` ç¬¦å·åè¾¹å£°æ˜å‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œä½†æ˜¯ä¸å¯ä»¥ä¸ºè¿”å›å€¼å‘½å
* åœ¨Rusté‡Œé¢ï¼Œè¿”å›å€¼å°±æ˜¯å‡½æ•°ä½“é‡Œé¢æœ€åä¸€ä¸ªè¡¨è¾¾å¼
* è‹¥æƒ³æå‰è¿”å›ï¼Œéœ€ä½¿ç”¨`return`å…³é”®å­—ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªå€¼
  * å¤§å¤šæ•°å‡½æ•°éƒ½æ˜¯é»˜è®¤ä½¿ç”¨æœ€åä¸€ä¸ªè¡¨è¾¾å¼æœ€ä¸ºè¿”å›å€¼

````rust
fn five(x: i32) -> i32 {
    x + 5 
}
fn main() {
    let x = five(6); // 5 + 6
    
    println!("The value of x is {}", x);
}
````

##### æ³¨é‡Š

* `//` å’Œ `/* */`
* Rustè¿˜æœ‰ä¸€ç§â€œæ–‡æ¡£æ³¨é‡Šâ€